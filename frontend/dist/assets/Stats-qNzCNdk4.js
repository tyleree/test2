import{r as u,k as e,T as k,V as L,W as D,Y as E,Z as V,_ as R}from"./vendor-CxiMA8KD.js";import{C as o,a as d,b as x,c as m,B as A,d as N}from"./card-B8W1J-ZB.js";import{B as g}from"./badge-CQXGlmqF.js";import{L as I}from"./vendor-router-BKMzhQks.js";import{u as U}from"./index-paEm-WqV.js";import{C as H,G as O,a as W}from"./vendor-maps-lnziv-MH.js";import{l as P}from"./vendor-charts-B_ZyQ9af.js";import"./vendor-ui-CIiL-PYC.js";const F="/static/us-states.json",K={"01":"AL","02":"AK","04":"AZ","05":"AR","06":"CA","08":"CO","09":"CT",10:"DE",11:"DC",12:"FL",13:"GA",15:"HI",16:"ID",17:"IL",18:"IN",19:"IA",20:"KS",21:"KY",22:"LA",23:"ME",24:"MD",25:"MA",26:"MI",27:"MN",28:"MS",29:"MO",30:"MT",31:"NE",32:"NV",33:"NH",34:"NJ",35:"NM",36:"NY",37:"NC",38:"ND",39:"OH",40:"OK",41:"OR",42:"PA",44:"RI",45:"SC",46:"SD",47:"TN",48:"TX",49:"UT",50:"VT",51:"VA",53:"WA",54:"WV",55:"WI",56:"WY",72:"PR"},T={AL:"Alabama",AK:"Alaska",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",DC:"District of Columbia",FL:"Florida",GA:"Georgia",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PA:"Pennsylvania",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming",PR:"Puerto Rico"},q=({className:s})=>{const[r,v]=u.useState(null),[y,w]=u.useState(!0),[j,S]=u.useState(null),[l,p]=u.useState(null);if(u.useEffect(()=>{const t=async()=>{try{const i=await fetch("/api/locations");if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const c=await i.json();console.log("ðŸ—ºï¸ Heat map received location data:",c),console.log("ðŸ—ºï¸ US states data:",c.us_states),console.log("ðŸ—ºï¸ Available state codes:",Object.keys(c.us_states||{})),v(c),S(null)}catch(i){console.error("Error fetching location data:",i),S(i instanceof Error?i.message:"Failed to fetch location data")}finally{w(!1)}};t();const a=setInterval(t,3e4);return()=>clearInterval(a)},[]),y)return e.jsxs(o,{className:s,children:[e.jsx(d,{children:e.jsx(x,{children:"Visitor Locations"})}),e.jsx(m,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-pulse text-muted-foreground",children:"Loading map..."})})})]});if(j||!r)return e.jsxs(o,{className:s,children:[e.jsx(d,{children:e.jsx(x,{children:"Visitor Locations"})}),e.jsx(m,{children:e.jsx("div",{className:"flex items-center justify-center h-64 text-muted-foreground",children:j?`Error: ${j}`:"No location data available"})})]});const h=Object.values(r.us_states),b=h.length>0?Math.max(...h):1,C=h.length>0?Math.min(...h.filter(t=>t>0)):0;console.log("ðŸŽ¨ Heat map color scale:",{maxCount:b,minCount:C,stateValues:h});const n=P().domain([0,b]).range(["#e0e7ff","#3b82f6"]),f=t=>{if(!t||!r)return 0;const a=[t.toUpperCase(),t.toLowerCase(),t];for(const i of a)if(r.us_states[i]!==void 0)return r.us_states[i];return 0},M=t=>{const a=f(t);return a===0?"#f8fafc":n(a)};return e.jsxs(o,{className:s,children:[e.jsx(d,{children:e.jsxs(x,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Visitor Locations"}),e.jsxs(g,{variant:"secondary",className:"text-xs",children:[r.total_tracked," tracked"]})]})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(H,{projection:"geoAlbersUsa",projectionConfig:{scale:1e3},width:800,height:500,className:"w-full h-auto",children:e.jsx(O,{geography:F,children:({geographies:t})=>t.map(a=>{const i=a.id,c=K[i]||i;f(c);const _=l===c;return e.jsx(W,{geography:a,fill:M(c),stroke:"#ffffff",strokeWidth:.5,style:{default:{outline:"none"},hover:{fill:_?"#1d4ed8":M(c),outline:"none",strokeWidth:1},pressed:{outline:"none"}},onMouseEnter:()=>p(c),onMouseLeave:()=>p(null)},a.rsmKey)})})}),l&&e.jsxs("div",{className:"absolute top-4 left-4 bg-background border rounded-lg p-3 shadow-lg z-10",children:[e.jsx("div",{className:"font-semibold",children:T[l]||l}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[f(l)," visitors"]})]})]}),e.jsx("div",{className:"flex items-center justify-between text-sm",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 bg-slate-100 border rounded"}),e.jsx("span",{className:"text-muted-foreground",children:"0 visitors"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-200 rounded"}),e.jsx("span",{className:"text-muted-foreground",children:"Low"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded"}),e.jsxs("span",{className:"text-muted-foreground",children:["High (",b,")"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-blue-600",children:Object.keys(r.us_states).length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"States Visited"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-green-600",children:Object.values(r.us_states).reduce((t,a)=>t+a,0)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"US Visitors"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-purple-600",children:r.international}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"International"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-orange-600",children:r.local+r.unknown}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Local/Unknown"})]})]}),Object.keys(r.us_states).length>0&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h4",{className:"font-semibold mb-3 text-sm",children:"Top States"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:Object.entries(r.us_states).sort(([,t],[,a])=>a-t).slice(0,6).map(([t,a])=>e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"font-medium",children:T[t]||t}),e.jsx(g,{variant:"outline",className:"text-xs",children:a})]},t))})]})]})})]})},X=()=>{const[s,r]=u.useState(null),[v,y]=u.useState(!0),[w,j]=u.useState(null),{toast:S}=U(),l=async()=>{try{const n=await fetch("/metrics");if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const f=await n.json();r(f),j(null)}catch(n){console.error("Error fetching stats:",n),j(n instanceof Error?n.message:"Failed to fetch statistics"),S({title:"Error",description:"Failed to fetch statistics. Please try again.",variant:"destructive"})}finally{y(!1)}};u.useEffect(()=>{l();const n=setInterval(l,3e4);return()=>clearInterval(n)},[]);const p=()=>{y(!0),l()},h=n=>{try{return new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(f){return"Unknown"}},b=()=>!s||s.visit_count===0?0:s.ask_count/s.visit_count*100,C=()=>!s||s.unique_visitors===0?0:s.ask_count/s.unique_visitors;return v&&!s?e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-background",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{className:"h-6 w-6 animate-spin"}),e.jsx("span",{className:"text-lg",children:"Loading statistics..."})]})}):w&&!s?e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-background",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-destructive",children:"Error Loading Statistics"}),e.jsx("p",{className:"text-muted-foreground",children:w}),e.jsxs(A,{onClick:p,variant:"outline",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Try Again"]}),e.jsx("div",{className:"mt-4",children:e.jsx(A,{asChild:!0,variant:"ghost",children:e.jsxs(I,{to:"/",children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Back to Home"]})})})]})}):e.jsx("div",{className:"min-h-screen bg-background py-12 px-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsxs("div",{className:"flex items-center justify-center mb-6",children:[e.jsx(A,{asChild:!0,variant:"ghost",className:"mr-4",children:e.jsxs(I,{to:"/",children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Back to Home"]})}),e.jsxs(A,{onClick:p,variant:"outline",disabled:v,children:[e.jsx(k,{className:`h-4 w-4 mr-2 ${v?"animate-spin":""}`}),"Refresh"]})]}),e.jsx("h1",{className:"text-5xl md:text-6xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-accent to-primary",children:"Statistics"}),e.jsx("p",{className:"text-xl text-muted-foreground mb-4",children:"Veterans Benefits AI Usage Analytics"}),s&&e.jsxs(g,{variant:"secondary",className:"text-sm",children:["Last updated: ",h(s.last_updated)]})]}),s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12",children:[e.jsxs(o,{className:"text-center",children:[e.jsxs(d,{className:"pb-3",children:[e.jsxs(x,{className:"flex items-center justify-center space-x-2",children:[e.jsx(D,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{children:"Questions Asked"})]}),e.jsx(N,{children:"Total questions processed by our AI"})]}),e.jsx(m,{children:e.jsx("div",{className:"text-4xl font-bold text-blue-500 mb-2",children:s.ask_count.toLocaleString()})})]}),e.jsxs(o,{className:"text-center",children:[e.jsxs(d,{className:"pb-3",children:[e.jsxs(x,{className:"flex items-center justify-center space-x-2",children:[e.jsx(E,{className:"h-5 w-5 text-green-500"}),e.jsx("span",{children:"Website Visits"})]}),e.jsx(N,{children:"Total page views since launch"})]}),e.jsx(m,{children:e.jsx("div",{className:"text-4xl font-bold text-green-500 mb-2",children:s.visit_count.toLocaleString()})})]}),e.jsxs(o,{className:"text-center",children:[e.jsxs(d,{className:"pb-3",children:[e.jsxs(x,{className:"flex items-center justify-center space-x-2",children:[e.jsx(V,{className:"h-5 w-5 text-purple-500"}),e.jsx("span",{children:"Unique Visitors"})]}),e.jsx(N,{children:"Different users who visited our site"})]}),e.jsx(m,{children:e.jsx("div",{className:"text-4xl font-bold text-purple-500 mb-2",children:s.unique_visitors.toLocaleString()})})]}),e.jsxs(o,{className:"text-center",children:[e.jsxs(d,{className:"pb-3",children:[e.jsxs(x,{className:"flex items-center justify-center space-x-2",children:[e.jsx(R,{className:"h-5 w-5 text-orange-500"}),e.jsx("span",{children:"Engagement Rate"})]}),e.jsx(N,{children:"Percentage of visits that asked questions"})]}),e.jsx(m,{children:e.jsxs("div",{className:"text-4xl font-bold text-orange-500 mb-2",children:[b().toFixed(1),"%"]})})]})]}),e.jsx("div",{className:"mb-12",children:e.jsx(q,{})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs(o,{children:[e.jsxs(d,{children:[e.jsx(x,{children:"Service Information"}),e.jsx(N,{children:"Details about our service performance"})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:"Service Started:"}),e.jsx("span",{className:"text-muted-foreground",children:h(s.first_visit)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:"Questions per Visit:"}),e.jsx("span",{className:"text-muted-foreground",children:(s.ask_count/Math.max(s.visit_count,1)).toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:"Questions per Unique User:"}),e.jsx("span",{className:"text-muted-foreground",children:C().toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:"Return Visitor Rate:"}),e.jsxs("span",{className:"text-muted-foreground",children:[s.unique_visitors>0?((1-s.unique_visitors/s.visit_count)*100).toFixed(1):0,"%"]})]})]})]}),e.jsxs(o,{children:[e.jsxs(d,{children:[e.jsx(x,{children:"Real-time Updates"}),e.jsx(N,{children:"Live statistics and system status"})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:"Status:"}),e.jsx(g,{variant:"default",className:"bg-green-500",children:"Live"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:"Auto-refresh:"}),e.jsx(g,{variant:"secondary",children:"Every 30 seconds"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:"Data Persistence:"}),e.jsx(g,{variant:"outline",children:"Across Restarts"})]}),e.jsx("div",{className:"text-sm text-muted-foreground pt-2",children:"Statistics are updated in real-time and persist across server restarts. All data is stored securely and anonymously."})]})]})]}),e.jsx("div",{className:"text-center mt-12 text-muted-foreground",children:e.jsx("p",{children:"Veterans Benefits AI - Trusted data, free forever"})})]})]})})};export{X as default};
